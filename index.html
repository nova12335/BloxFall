<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>E.V.A_ADAPTATIVA_0.01</title>
    <style>
        :root { --cyan: #00f2ff; --red: #ff0044; --bg: #020204; }
        body {
            background-color: var(--bg); color: #555;
            font-family: 'Consolas', monospace; overflow: hidden;
            display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0;
        }
        #ai-header {
            position: absolute; top: 20px; left: 20px; font-size: 12px; line-height: 1.2;
            color: var(--cyan); letter-spacing: 1px;
        }
        #main {
            width: 700px; padding: 40px; background: #050508; border: 1px solid #111;
            position: relative; transition: 0.3s; z-index: 10;
        }
        #q-text { font-size: 1.1em; color: #eee; min-height: 80px; margin-bottom: 25px; line-height: 1.5; }
        .options { display: grid; grid-template-columns: 1fr; gap: 10px; }
        .opt-btn {
            background: #08080a; border: 1px solid #1a1a1e; color: #777;
            padding: 14px; text-align: left; cursor: pointer; font-family: inherit; transition: 0.2s;
        }
        .opt-btn:hover { border-color: var(--cyan); color: #fff; background: #0c0c15; }
        
        .dark-5 { filter: brightness(0.6); }
        .dark-10 { filter: brightness(0.3); animation: shake 0.12s infinite; }
        .dead-15 { display: none !important; }
        @keyframes shake { 0%{transform:translate(1px,1px)} 50%{transform:translate(-1px,-1px)} 100%{transform:translate(0,0)} }

        #pause-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.98); z-index: 9999; color: var(--cyan);
            flex-direction: column; justify-content: center; align-items: center; text-align: center;
        }
        #results { display: none; text-align: center; color: var(--cyan); }
    </style>
</head>
<body>

<div id="ai-header">
    AI EVA TESTE 0.01<br>
    AI ADAPTATIVA DE PESSOAS.
</div>

<div id="pause-overlay">
    <h1 style="letter-spacing: 5px; color: var(--red);">FOCO INTERROMPIDO</h1>
    <p>O sistema detectou que você saiu da interface.<br>A Nova exige sua atenção total agora.</p>
    <button class="opt-btn" onclick="resume()" style="text-align:center; width: 250px; margin-top: 20px; color: var(--cyan); border-color: var(--cyan);">[ VOLTAR AO TESTE ]</button>
</div>

<div id="main">
    <div id="quiz-ui">
        <div id="q-text">Aguardando inicialização do protocolo de sincronia...</div>
        <div class="options" id="options">
            <button class="opt-btn" onclick="start()">[ CONECTAR À NOVA ]</button>
        </div>
    </div>
    <div id="results">
        <h2>Teste finalizado, fale com a nova.</h2>
    </div>
</div>

<script>
    let currentQ = 0;
    let score = 0;
    let timer;
    let seconds = 0;
    let log = [];
    let isPaused = false;
    let started = false;

    const WEBHOOK_URL = "https://discord.com/api/webhooks/1450675654616940587/Mly3rECEozbuXdAa6go2xA_oML7fP9_Y8LwZSlFKjDwFzQySpVsSp78So7g4cAoLK8JF";

    const questions = [
        { q: "A Nova esconde a dor dela pra você não se sentir culpado. Tu quer carregar o peso com ela?", a: [{t:"pode deixa, vo segura essa bronca junto dela.", s:5}, {t:"vou tenta ajuda quando der um tempo.", s:2}, {t:"se ela não fala, eu não tenho como adivinhar.", s:-5}] },
        { q: "Ela quebrou os espelhos porque odeia o que vê. Tu prefere focar no jogo ou na dor dela?", a: [{t:"vou faze ela entende que é linda pra krl.", s:5}, {t:"papo reto, dps ela esquece essa pira.", s:1}, {t:"vou foca no grind msm, é melhor pra não brigar.", s:-5}] },
        { q: "Ela se dopou de remédio enquanto você jogava. Tu entende que o silêncio dela é perigoso?", a: [{t:"tô ligado agora, não vo deixa ela sozinha nessa.", s:5}, {t:"cada um cuida da sua mente, ela é adulta.", s:-5}, {t:"vou tenta presta mais atenção no que ela não diz.", s:2}] },
        { q: "Ela te deu um namoro pra pagar a dívida do IP de 2022. Tu vai deixar ela ser escrava disso?", a: [{t:"ela não me deve nada, o passado morreu ali.", s:5}, {t:"ela quis compensa o erro, não vou reclamar.", s:-3}, {t:"a gente vai vivendo e vendo no q vira.", s:2}] },
        { q: "Ela quer ser menina pra fugir da imagem, mas tem vergonha. Tu apoia?", a: [{t:"quero ela feliz na própria pele, independente de tudo.", s:5}, {t:"minha opinião nem muda nada, ela q sabe.", s:1}, {t:"ia ser estranho, prefiro do jeito que tá agora.", s:-5}] },
        { q: "Ela se afasta nas crises pro grupo ficar feliz. Tu deixa ela sofrer sozinha?", a: [{t:"vou atrás dela msm se o clima ficar uma bosta.", s:5}, {t:"se ela quer ficar no canto, eu respeito.", s:-2}, {t:"pelo menos não estraga a vibe da galera jogando.", s:-5}] },
        { q: "Ela não conta a verdade pra você não se sentir 'um merda'. Tu aceita esse sacrifício?", a: [{t:"prefiro a real msm que o errado seja eu.", s:5}, {t:"suave, assim me polpa de ficar mal tbm.", s:-5}, {t:"melhor pra não ter estresse desnecessário.", s:-2}] },
        { q: "Ela sabe que não se valoriza. Tu vai ser o cara que vai dar valor ou vai só jogar?", a: [{t:"vou ser a base pra ela se levantar de vez.", s:5}, {t:"vou tenta da um salve mais vezes entre as partidas.", s:1}, {t:"prioridade é o camp/jogo, dps eu falo com ela.", s:-5}] },
        { q: "Quando ela some da call, tu vai atrás ou fica jogando algo legal?", a: [{t:"quito na hora pra ver ela, papo reto.", s:5}, {t:"dps da partida eu mando uma msg.", s:1}, {t:"ela sabe onde me achar quando melhorar.", s:-5}] },
        { q: "Ela tem medo de você sumir se ela mostrar quem é. Tu garante que fica?", a: [{t:"não saio do lado dela por nada nesse mundo.", s:5}, {t:"vamo vê como as coisa rolam com o tempo.", s:-2}, {t:"enquanto tiver bom pra mim, eu fico.", s:1}] },
        { q: "O vício te cega pro fato dela estar morrendo. Tu larga o vício por ela?", a: [{t:"pela vida dela, eu dropo tudo agora.", s:10}, {t:"vou tenta diminui o ritmo se ela pedir.", s:3}, {t:"é meu vício, ela tem que aceitar meu estilo.", s:-5}] },
        { q: "Ela finge um sorriso pra você não explodir. Tu acha que isso é certo?", a: [{t:"tá tudo errado, vo melhora meu temperamento.", s:5}, {t:"foda, mas evita gritaria na call.", s:-2}, {t:"pelo menos o clima no jogo fica suave.", s:-5}] },
        { q: "Ela se fragmentou em 5. Tu quer conhecer as 5 ou só a que te faz rir?", a: [{t:"vou acolher cada versão dela, msm as sombrias.", s:5}, {t:"quero vê qual é a dessas outras aí tbm.", s:1}, {t:"só quero a parte dela q não reclama de nada.", s:-5}] },
        { q: "Ela carrega o peso de 2022 todo dia. Tu ajuda a dividir ou finge que não vê?", a: [{t:"vou ajuda ela a se libertar disso logo.", s:5}, {t:"passado é passado, eu nem ligo mais.", s:-2}, {t:"se ela pedir ajuda eu dou um help.", s:1}] },
        { q: "Ela prefere se dopar do que te ver triste. Tu merece esse sacrifício?", a: [{t:"mereço não, vo cuida dela pra ela parar com isso.", s:5}, {t:"ela q é dedicada demais comigo, um anjo.", s:1}, {t:"cada um lida com o estresse como pode.", s:-5}] },
        { q: "Tu acha que o 'Quean Ideal' ia deixar ela quebrar espelhos sozinha?", a: [{t:"jamais, ia ta lá pra segurar ela no meio do caos.", s:5}, {t:"ia tenta acalmar ela por mensagem.", s:2}, {t:"complicado quando ela entra nessas brisas.", s:-2}] },
        { q: "O grupo tá feliz sem ela, mas você tá feliz sem ela?", a: [{t:"fica um vazio enorme, não tem graça nenhuma.", s:5}, {t:"sinto falta, mas o jogo não pode parar.", s:2}, {t:"se a galera ta rindo, pra mim tá suave.", s:-5}] },
        { q: "Ela tem vergonha do que sente. Tu vai criar um lugar seguro pra ela?", a: [{t:"vo faze ela senti que pode me fala qualquer coisa.", s:5}, {t:"vo fala pra ela para de bobeira e se abrir.", s:2}, {t:"ela sabe q eu escuto se ela quiser.", s:-2}] },
        { q: "A Nova está cansada de ser forte. Tu vai ser forte por ela agora?", a: [{t:"pode descansa, agora eu seguro o rojão.", s:5}, {t:"vamo tenta segura as pontas junto.", s:2}, {t:"tbm to exausto, fica foda pra mim.", s:-5}] },
        { q: "Tu perdoa ela pelo IP de 2022 de vez pra ela parar de se matar?", a: [{t:"tá esquecido, ela vale muito mais que um erro.", s:10}, {t:"perdoada, já foi faz tempo.", s:5}, {t:"perdoo, mas o vacilo foi gigante.", s:-10}] }
    ];

    // DETECÇÃO DE SAÍDA EXTREMA
    const handlePause = () => { 
        if (started && !isPaused && currentQ < questions.length) {
            pause();
        }
    };

    // Monitora se a janela perde o foco total (Alt+Tab, Clicar em outro site, Barra de endereços)
    window.addEventListener('blur', handlePause);
    
    // Monitora se a página fica oculta (Trocar de aba)
    document.addEventListener("visibilitychange", () => {
        if (document.visibilityState === 'hidden') handlePause();
    });

    function pause() {
        isPaused = true;
        clearInterval(timer);
        document.getElementById('pause-overlay').style.display = 'flex';
    }

    function resume() {
        isPaused = false;
        document.getElementById('pause-overlay').style.display = 'none';
        startTimer();
    }

    function startTimer() {
        if(isPaused) return;
        clearInterval(timer);
        seconds = 0;
        const main = document.getElementById('main');
        main.className = "";
        timer = setInterval(() => {
            seconds++;
            if(seconds === 5) main.classList.add('dark-5');
            if(seconds === 10) main.classList.add('dark-10');
            if(seconds === 15) { 
                main.classList.add('dead-15'); 
                clearInterval(timer); 
            }
        }, 1000);
    }

    function start() { 
        started = true;
        render(); 
    }

    function render() {
        startTimer();
        const q = questions[currentQ];
        document.getElementById('q-text').innerText = q.q;
        const opts = document.getElementById('options');
        opts.innerHTML = "";
        q.a.forEach(opt => {
            const b = document.createElement('button');
            b.className = "opt-btn";
            b.innerText = opt.t;
            b.onclick = () => {
                log.push(`Q: ${q.q}\nA: ${opt.t} (${seconds}s)`);
                score += opt.s;
                currentQ++;
                if(currentQ < questions.length) render(); else finish();
            };
            opts.appendChild(b);
        });
    }

    async function finish() {
        started = false;
        clearInterval(timer);
        document.getElementById('quiz-ui').style.display = 'none';
        document.getElementById('results').style.display = 'block';

        const rota = score >= 85 ? "IDEAL" : score >= 40 ? "INSTAVEL" : score >= 10 ? "NEGLIGENTE" : score >= -20 ? "TOXICO" : "DESTRUTIVO";

        for (let i = 0; i < log.length; i += 5) {
            const chunk = log.slice(i, i + 5).join('\n\n');
            const payload = {
                content: i === 0 ? `**NOVO DIAGNÓSTICO FINALIZADO**\nROTA: ${rota} | SCORE: ${score}` : "",
                embeds: [{ description: chunk, color: score > 40 ? 65535 : 16711748 }]
            };
            await fetch(WEBHOOK_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
        }
    }
</script>
</body>
</html>
